{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nexport function middleware(request: NextRequest) {\n  // Log API requests\n  if (request.nextUrl.pathname.startsWith('/api/') && request.method !== 'GET') {\n    const ip = request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown';\n    console.log('[API REQUEST]', {\n      method: request.method,\n      path: request.nextUrl.pathname,\n      ip,\n      userAgent: request.headers.get('user-agent'),\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  // Protect /admin routes (except login page)\n  if (request.nextUrl.pathname.startsWith('/admin')) {\n    // Allow access to admin login page\n    if (request.nextUrl.pathname === '/admin' || request.nextUrl.pathname === '/admin/') {\n      return NextResponse.next();\n    }\n\n    const adminSession = request.cookies.get('admin-session');\n    \n    if (!adminSession) {\n      // Redirect to login if no session\n      return NextResponse.redirect(new URL('/', request.url));\n    }\n\n    try {\n      const sessionData = JSON.parse(adminSession.value);\n      \n      // Check if session is expired (5 minutes)\n      const sessionTime = new Date(sessionData.timestamp).getTime();\n      const now = Date.now();\n      const fiveMinutes = 5 * 60 * 1000;\n      \n      if (now - sessionTime > fiveMinutes || !sessionData.isAuthenticated) {\n        // Session expired, redirect to home\n        const response = NextResponse.redirect(new URL('/', request.url));\n        response.cookies.delete('admin-session');\n        return response;\n      }\n    } catch (error) {\n      // Invalid session, redirect to home\n      const response = NextResponse.redirect(new URL('/', request.url));\n      response.cookies.delete('admin-session');\n      return response;\n    }\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: '/admin/:path*',\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGO,SAAS,WAAW,OAAoB;IAC7C,mBAAmB;IACnB,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,YAAY,QAAQ,MAAM,KAAK,OAAO;QAC5E,MAAM,KAAK,QAAQ,OAAO,CAAC,GAAG,CAAC,sBAAsB,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;QACzF,QAAQ,GAAG,CAAC,iBAAiB;YAC3B,QAAQ,QAAQ,MAAM;YACtB,MAAM,QAAQ,OAAO,CAAC,QAAQ;YAC9B;YACA,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC;YAC/B,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;IAEA,4CAA4C;IAC5C,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW;QACjD,mCAAmC;QACnC,IAAI,QAAQ,OAAO,CAAC,QAAQ,KAAK,YAAY,QAAQ,OAAO,CAAC,QAAQ,KAAK,WAAW;YACnF,OAAO,gMAAY,CAAC,IAAI;QAC1B;QAEA,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEzC,IAAI,CAAC,cAAc;YACjB,kCAAkC;YAClC,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;QACvD;QAEA,IAAI;YACF,MAAM,cAAc,KAAK,KAAK,CAAC,aAAa,KAAK;YAEjD,0CAA0C;YAC1C,MAAM,cAAc,IAAI,KAAK,YAAY,SAAS,EAAE,OAAO;YAC3D,MAAM,MAAM,KAAK,GAAG;YACpB,MAAM,cAAc,IAAI,KAAK;YAE7B,IAAI,MAAM,cAAc,eAAe,CAAC,YAAY,eAAe,EAAE;gBACnE,oCAAoC;gBACpC,MAAM,WAAW,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;gBAC/D,SAAS,OAAO,CAAC,MAAM,CAAC;gBACxB,OAAO;YACT;QACF,EAAE,OAAO,OAAO;YACd,oCAAoC;YACpC,MAAM,WAAW,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;YAC/D,SAAS,OAAO,CAAC,MAAM,CAAC;YACxB,OAAO;QACT;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;AACX"}}]
}